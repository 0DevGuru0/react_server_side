!function(r){var t={};function o(e){if(t[e])return t[e].exports;var n=t[e]={i:e,l:!1,exports:{}};return r[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=r,o.c=t,o.d=function(e,n,r){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var t in n)o.d(r,t,function(e){return n[e]}.bind(null,t));return r},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="",o(o.s=40)}([function(e,n){e.exports=require("graphql")},function(e,n){e.exports=require("validator")},function(e,n,r){"use strict";var t=r(4),o=r(1),i=r.n(o),a=r(14),s=new t.Schema({name:{type:String,trim:!0,required:!0},email:{type:String,required:!0,unique:!0,lowercase:!0,index:!0,trim:!0,validate:{validator:function(e){return i.a.isEmail(e)},message:"{VALUE} is not a valid {PATH}"}},password:{type:String,required:!0,unique:!0,trim:!0},googleId:{type:String},isVerified:{type:Boolean},createdAt:{type:String},updatedAt:{type:String}});s.method("comparePassword",function(e,r){Object(a.compare)(e,this.password,function(e,n){r(e,n)})}),s.pre("save",function(r){var t=this;if(!t.isModified)return r();Object(a.genSalt)(10,function(e,n){if(e)return r("some thing went wrong");Object(a.hash)(t.password,n,function(e,n){if(e)return r("can't hash the password,try again");t.password=n,r()})})});var u=Object(t.model)("user",s);n.a=u},function(e,n){e.exports=require("passport")},function(e,n){e.exports=require("mongoose")},function(e,n,r){e.exports=r(34)},function(e,n){e.exports=require("moment")},function(e,n){e.exports=require("jsonwebtoken")},function(e,n){e.exports=require("path")},function(e,n){function u(e,n,r,t,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?n(u):Promise.resolve(u).then(t,o)}e.exports=function(s){return function(){var e=this,a=arguments;return new Promise(function(n,r){var t=s.apply(e,a);function o(e){u(t,n,r,o,i,"next",e)}function i(e){u(t,n,r,o,i,"throw",e)}o(void 0)})}}},function(e,n){e.exports=require("express")},function(e,n){e.exports=require("redis")},function(e,n){e.exports=require("chalk")},function(e,n){e.exports=require("@sendgrid/mail")},function(e,n){e.exports=require("bcrypt")},function(e,n){e.exports=require("dotenv")},function(e,n){e.exports=require("body-parser")},function(e,n){e.exports=require("fs")},function(e,n){e.exports=require("express-session")},function(e,n){e.exports=require("cookie-parser")},function(e,n){e.exports=require("cors")},function(e,n){e.exports=require("x-xss-protection")},function(e,n){e.exports=require("hpp")},function(e,n){e.exports=require("pdfkit")},function(e,n,r){var o=r(35);e.exports=function(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},t=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.forEach(function(e){o(n,e,r[e])})}return n}},function(e,n,r){var t=r(4),o=t.Schema,i=new o({IP:{type:String},visitedDay:{type:String},IPsInfo:{type:o.Types.ObjectId,ref:"visitorsInfo"}});e.exports=t.model("visitorsIP",i)},function(e,n,r){var t=r(4),o=new t.Schema({continent_name:{type:String},country_name:{type:String},state_prov:{type:String},district:{type:String},latitude:{type:Number},longitude:{type:Number},calling_code:{type:String},languages:{type:String},organization:{type:String},currency:{type:String}});e.exports=t.model("visitorsInfo",o)},function(e,n){e.exports=require("http")},function(e,n){e.exports=require("morgan")},function(e,n){e.exports=require("rotating-file-stream")},function(e,n){e.exports=require("express-graphql")},function(e,n){e.exports=require("ioredis")},function(e,n){e.exports=require("passport-google-oauth20")},function(e,n){e.exports=require("passport-local")},function(e,n){e.exports=require("regenerator-runtime")},function(e,n){e.exports=function(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}},function(e,n){e.exports=require("ip-geolocation-api-javascript-sdk/GeolocationParams.js")},function(e,n){e.exports=require("ip-geolocation-api-javascript-sdk/IPGeolocationAPI")},function(e,n,r){"use strict";r.r(n);var t=r(5),a=r.n(t),o=r(9),i=r.n(o),s=r(3),u=r.n(s),c=r(32),l=r(2),p=r(8),f=r.n(p),d=r(33),m=r.n(d),g=r(6),h=r.n(g),y=r(11),v=r.n(y).a.createClient();r(15).config({path:f.a.resolve(process.cwd(),"config/keys/.env")}),u.a.serializeUser(function(e,n){n(null,e.id)}),u.a.deserializeUser(function(e,n){l.a.findById(e).then(function(e){n(null,e)})});var w={clientID:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET,callbackURL:process.env.GOOGLE_AUTH_SUCCESS_CALLBACK,proxy:!0},b=new c.Strategy(w,function(){var o=i()(a.a.mark(function e(n,r,t,o){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.findOne({googleId:t.id});case 2:if(i=e.sent)return v.hset("lastLogIn",i.id,h()().format()),e.abrupt("return",o(null,i));e.next=6;break;case 6:new l.a({name:t.displayName,email:t.emails[0].value,password:t.id,googleId:t.id,createdAt:h()().format(),updatedAt:null,isVerified:!0}).save(function(e,n,r){if(e)return o(e,null);o(null,n)});case 8:case"end":return e.stop()}},e)}));return function(e,n,r,t){return o.apply(this,arguments)}}()),x=new m.a({usernameField:"email"},function(e,n,t){l.a.findOne({email:e.toLowerCase()},function(e,r){return e?t(e):r?void r.comparePassword(n,function(e,n){return e?t(e):n?(v.hset("lastLogIn",r.id,h()().format()),t(null,r)):t(null,!1,"Invalid_Credential")}):t(null,!1)})});u.a.use(x),u.a.use(b)},function(e,n){e.exports=require("connect-redis")},function(e,n,r){"use strict";r.r(n);var t=r(10),o=r.n(t),i=r(4),a=r.n(i),s=r(16),u=r.n(s),c=r(3),l=r.n(c),p=r(8),f=r.n(p),d=r(17),m=r.n(d),g=r(18),h=r.n(g),y=r(19),v=r.n(y),w=r(20),b=r.n(w),x=r(21),S=r.n(x),E=r(22),P=r.n(E),q=function(e,n,r){e.user?r():n.status(404).send({error:"You must log in!"})},L=r(5),O=r.n(L),G=r(9),I=r.n(G),_=r(7),k=r.n(_),R=r(2),N=r(23),D=r.n(N),j={},Q=[{id:1,name:"Kurtis Weissnat"},{id:2,name:"Nicholas Runolfsdottir"},{id:3,name:"Gelann Reichert"},{id:4,name:"Moriah Stanton"},{id:5,name:"Rey Padberg"}];j.rootPage=function(e,n){var r='\n        <div>\n        You don\'t appear to be logged in.  You can log in by visiting\n        <a href="/auth/google">the Authentication Route</a>. You could\n        also look at details about yourself at <a href="/api/current_user">the Current User route</a>\n        </div>\n    ';e.user&&(r='\n        <div>\n            You appear to be logged in, so you can visit <a href="/admins">the Admins route</a>\n            or you can\n            <form action="/logout" method="post">\n                <input type="hidden" name="_csrf" value="'.concat(e.csrfToken(),'"></input>\n                <button type="submit">Logout</button>\n            </form>\n        </div>\n        ')),n.send('\n        <div>\n        <h4>Hi!  Welcome to the React SSR API</h4>\n        <div>\n        <form action="/userslistpdf" method="get">\n        <button>usersListPdf</button>\n        </form>\n            You can see <a href="/users">the Users route</a>\n        </div>\n        '.concat(r,"\n        </div>\n    "))},j.usersList=function(e,i,n){var a,s=+e.query.page;s<1&&(s=1),R.a.find().countDocuments().then(function(e){return a=e,s>Math.ceil(a/10)&&(s=Math.ceil(a/10)),R.a.find().skip(10*(s-1)).limit(10)}).then(function(e){if(!e)return"no user has been registered yet";var n=e.map(function(e){return{_id:e._id,name:e.name,email:e.email,isVerified:e.isVerified}}),r=10*s<a,t=1<s,o=Math.ceil(a/10);i.send({Users:n,totalUsers:a,hasNextPage:r,hasPreviousPage:t,currentPage:s,lastPage:o})}).catch(function(e){n(new Error(e))})},j.logIn=function(e,n){n.send('\n    <html>\n      <body>\n        <a href="auth/google">Login via Google</a>\n      </body>\n    </html>')},j.admins=function(e,n){n.send(Q)},j.redirectToRoot=function(e,n){n.redirect("/")},j.logOut=function(){var r=I()(O.a.mark(function e(n,r){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.logout();case 2:r.redirect("/");case 3:case"end":return e.stop()}},e)}));return function(e,n){return r.apply(this,arguments)}}(),j.emailVerification=function(e,r,t){var n=e.query.token;k.a.verify(n,"afsan|user|emailVerify|007",{subject:"emailVerification"},function(e,n){if(e)return"TokenExpiredError"===e.name?r.status(500).send("request expired please try again"):r.send({err:e});R.a.findOneAndUpdate({email:n.email},{$set:{isVerified:!0}},{new:!0},function(e,n){e&&t(new Error("can't find Email try again")),r.redirect("/")})})},j.resetPassword=function(e,r,n){var t=e.query.token;k.a.verify(t,"afsan|user|resetPassword|007",{subject:"resetPassword"},function(e,n){if(e)return"TokenExpiredError"===e.name?r.status(500).send("request expired please try again"):r.send({err:e});r.send({email:n.email})})},j.printUsers=function(e,t,n){t.setHeader("Content-Type","application/pdf"),t.setHeader("Content-Disposition",'inline;filename="usersList"'),R.a.find().then(function(){var n=I()(O.a.mark(function e(n){var r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return","no user has been registered yet");case 2:r=new D.a,t.setHeader("Content-Type","application/pdf"),"userslist",t.setHeader("Content-Disposition",'inline; filename="userslist"'),r.pipe(t),r.fontSize(26).text("Invoice",{underline:!0}),r.text("-----------------------"),(n=n.map(function(e){return{name:e.name,email:e.email}})).forEach(function(e,n){r.text(n+")"+e.email+"---"+e.name)}),r.text("---"),r.end();case 13:case"end":return e.stop()}},e)}));return function(e){return n.apply(this,arguments)}}()).catch(function(e){n(new Error(e))})};var T=j,C=r(24),U=r.n(C),A=r(11),V=r.n(A),Y=r(6),M=r.n(Y),B=r(12),F=r.n(B),z=r(25),H=r.n(z),K=r(26),J=r.n(K);r(15).config({path:f.a.resolve(process.cwd(),"config/keys/.env")});var W=V.a.createClient({retry_strategy:function(){return 1e3}});W.on("error",function(e){console.log(F.a.bgRedBright.bold("ERROR:")+F.a.bold("connecting to redis encountered with issue.\n"))});var $=r(36),X=new(r(37))(process.env.GEOLOCATION_IP_ADDRESS),Z={},ee=M()().format("YYYY/M/D");function ne(e){var n=e.message,r=e.sourceCode,t=e.errorDetail;return F.a.white.bgRed.bold("\nERROR||")+"".concat(n,"\n")+"sourceCode:"+F.a.redBright.bold("[ipInfoSystem_".concat(r,")]\n"))+"[detail]:"+F.a.redBright.bold("".concat(JSON.stringify(t)))+"\n"}Z.storeSystem=function(){var r=I()(O.a.mark(function e(s,t){var n,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=new Date,(r=new Date(n.getFullYear(),n.getMonth(),n.getDate(),24,0,0,0)-n)<0&&(r+=864e5),setInterval(function(){var a=M()().subtract(1,"day").format("YYYY/M/D");W.hgetall(a,function(e,n){if(e)return s(ne({message:"Something went wrong on redis",sourceCode:"FetchVisitorDataFromRedis",errorDetail:e}));if(null==n)return s(ne({message:"receiving null as result for redis query ",sourceCode:"FetchVisitorDataFromRedis",errorDetail:"{queryResult:null}"}));var r=[];for(var t in n){var o=new J.a(JSON.parse(n[t])),i=new H.a({IP:t,visitedDay:a});i.IPsInfo=o,Promise.all([i.save(),o.save()]).catch(function(e){e&&r.push(e)})}if(0!==r.length)return s(ne({message:"something went wrong on storing fetched data from redis on mongoDB",sourceCode:"StoreFetchedDataOnDB",errorDetail:r}));W.del(a)})},r+2e4),W.hget(ee,t,function(e,n){if(e)return s(ne({message:"Something went wrong on redis",sourceCode:"FetchVisitorDataFromRedis",errorDetail:e}));if(null!==n)return s(null);var r=new $;r.setFields(["continent_name","country_name","state_prov","district","latitude","longitude","calling_code","languages","organization","currency"].join(",")),X.getGeolocation(function(e){if(e.message)return s(ne({message:"something went wrong on fetching IP information from protocol",sourceCode:"fetchInfoFromProtocol",errorDetail:e.message}));delete e.ip,e=U()({},e,{currency:e.currency.code}),e=JSON.stringify(e),W.hset(ee,t,e)},r)});case 5:case"end":return e.stop()}},e)}));return function(e,n){return r.apply(this,arguments)}}();var re=Z,te=o.a.Router(),oe=l.a.authenticate("google",{scope:["profile","email"]}),ie=l.a.authenticate("google");te.get("/auth/google",oe),te.get("/api/auth/google/callback",ie,T.redirectToRoot),te.get("/auth/google/callback",ie,T.redirectToRoot),te.post("/logout",q,T.logOut),te.get("/logout",q,T.logOut),te.get("/current_user",q,function(e,n){n.send(e.user)}),te.get("/emailverify",T.emailVerification,T.redirectToRoot),te.get("/resetPassword",T.resetPassword),te.get("/usersListPdf",T.printUsers),te.post("/userInfo",function(e,n){re.storeSystem(function(e){e&&console.log(e)},e.body.ip),n.end()});var ae=te,se=o.a.Router();se.get("/",T.rootPage),se.get("/users",T.usersList),se.get("/admins",q,T.admins),se.get("/login",T.logIn);var ue=se,ce=r(27),le=r.n(ce),pe=r(28),fe=r.n(pe),de=r(29),me=r.n(de),ge=r(30),he=r.n(ge),ye=r(0),ve=new ye.GraphQLObjectType({name:"UserType",fields:{id:{type:ye.GraphQLID},name:{type:ye.GraphQLString},email:{type:ye.GraphQLString},isVerified:{type:ye.GraphQLBoolean}}}),we=r(1),be=r.n(we),xe=r(13),Se=r.n(xe),Ee=r(7),Pe=function(e){return{to:e.email,subject:"Successfully SignedIn[".concat(e.name,"]"),from:"af.hadafi@gmail.com",text:"and easy to do anywhere, even with Node.js",html:function(e){var n=Ee.sign({email:e.email,access:"simple_user"},"afsan|user|emailVerify|007",{expiresIn:3600,subject:"emailVerification"});return"\n    <html>\n        <body>\n            <div>\n                <h1>Email Verification</h1>\n                <a href='http://localhost:3000/api/emailverify?token=".concat(n,"'>\n                    <button>verifying my account</button>\n                </a>\n            </div>\n        </body>\n    </html>\n    ")}(e)}},qe=r(7),Le=function(e){return{to:e.email,subject:"Rest Password",from:"af.hadafi@gmail.com",text:"and easy to do anywhere, even with Node.js",html:function(e){var n=qe.sign({email:e.email,access:"simple_user"},"afsan|user|resetPassword|007",{expiresIn:3600,subject:"resetPassword"});return"\n    <html>\n        <body>\n            <div>\n                <h1>resetPassword</h1>\n                <a href='http://localhost:3000/resetPassword/".concat(n,"'>\n                    <button>reset my account Password</button>\n                </a>\n            </div>\n        </body>\n    </html>\n    ")}(e)}},Oe=V.a.createClient(),Ge={SignUp:function(e){var n=e.email,r=e.password,t=e.name,o=e.req,i=[];if((be.a.isEmpty(n)||be.a.isEmpty(r))&&i.push("type all credentials"),be.a.isEmail(n)||i.push("type valid Email"),be.a.isLength(r,{min:6,max:24})||i.push("password should be in 6 to 24 char range"),0<i.length)throw new Error(i);return R.a.findOne({email:n}).then(function(e){if(e)throw new Error("Email is in use");return new R.a({email:n,password:r,name:t,createdAt:M()().format(),updatedAt:null,isVerified:!1}).save()}).then(function(t){return new Promise(function(n,r){o.login(t,function(e){return e&&r(e),Oe.hset("lastLogIn",t.id,M()().format()),n(t)})})}).catch(function(e){throw new Error(e)})},SignIn:function(e){var n=e.email,o=e.password,i=e.req,r=[];if((be.a.isEmpty(n)||be.a.isEmpty(o))&&r.push("type all credentials"),be.a.isEmail(n)||r.push("type valid Email"),0<r.length)throw new Error(r);return new Promise(function(r,t){l.a.authenticate("local",function(e,n){return n?e?t(e):void i.login(n,function(e){return e?t(e):r(n)}):t("you are not registered yet please signUp first")})({body:{email:n,password:o}})})},sendEmailVerify:function(e){var o=e.email,n=(e.req,[]);if(be.a.isEmpty(o)&&n.push("email should be insert"),be.a.isEmail(o)||n.push("type valid Email"),0<n.length)throw new Error(n);return R.a.findOne({email:o}).then(function(e){if(be.a.isEmpty(e))throw new Error("user with this email doesn't exist");return Se.a.setApiKey(process.env.SEND_GRID_API_KEY),new Promise(function(r,t){Se.a.send(Pe(e),!0,function(e,n){return e?t(e):r({email:o})})})}).catch(function(e){throw new Error(e)})},sendResetPassEmail:function(e){var o=e.email,n=(e.req,[]);if(be.a.isEmpty(o)&&n.push("email should be insert"),be.a.isEmail(o)||n.push("type valid Email"),0<n.length)throw new Error(n);return R.a.findOne({email:o}).then(function(e){if(be.a.isEmpty(e))throw new Error("user with this email doesn't exist");return Se.a.setApiKey(process.env.SEND_GRID_API_KEY),new Promise(function(r,t){Se.a.send(Le(e),!0,function(e,n){return e?t(e.message):r({email:o})})})}).catch(function(e){throw new Error(e)})},identifyUserByToken:function(e){var n=e.token;e.req;if(be.a.isEmpty(n))throw new Error("token has not been received.");return n=be.a.trim(n),new Promise(function(r,t){return k.a.verify(n,"afsan|user|resetPassword|007",{subject:"resetPassword"},function(e,n){if(e)return"TokenExpiredError"===e.name?t("request expired please try again"):t(e);r({email:n.email})})})},updateUserPassword:function(e){var n=e.email,r=e.password,t=(e.req,[]);if((be.a.isEmpty(n)||be.a.isEmpty(r))&&t.push("type all credentials"),be.a.isEmail(n)||t.push("type valid Email"),be.a.isLength(r,{min:6,max:24})||t.push("password should be in 6 to 24 char range"),0<t.length)throw new Error(t);return R.a.findOne({email:n}).then(function(e,n){if(n)throw new Error("something went wrong,try again");if(!e)throw new Error("User not found");return e.password=r,e.save()}).then(function(e){Promise.resolve({email:n})}).catch(function(e){throw new Error(e)})}},Ie=Ge,_e=new ye.GraphQLObjectType({name:"RootQueryType",fields:function(){return{user:{type:ve,resolve:function(e,n,r){return r.user}},identifyUserByToken:{type:ve,args:{token:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n,r){var t=n.token;return Ie.identifyUserByToken({token:t,req:r})}}}}}),ke=new ye.GraphQLObjectType({name:"PageView",fields:{field:{type:ye.GraphQLString},counted:{type:ye.GraphQLInt}}}),Re=r(31),Ne=new(r.n(Re).a),De=new ye.GraphQLObjectType({name:"MutationObserver",fields:function(){return{SignIn:{type:ve,args:{email:{type:new ye.GraphQLNonNull(ye.GraphQLString)},password:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n,r){var t=n.password,o=n.email;return console.log(t,o),Ie.SignIn({email:o,password:t,req:r})}},SignUp:{type:ve,args:{name:{type:new ye.GraphQLNonNull(ye.GraphQLString)},email:{type:new ye.GraphQLNonNull(ye.GraphQLString)},password:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n,r){var t=n.email,o=n.password,i=n.name;return Ie.SignUp({email:t,password:o,name:i,req:r})}},SignOut:{type:ve,resolve:function(e,n,r){var t=r.user;return r.logout(),t}},sendEmailVerify:{type:ve,args:{email:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n,r){var t=n.email;return Ie.sendEmailVerify({email:t,req:r})}},sendResetPassEmail:{type:ve,args:{email:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n,r){var t=n.email;return Ie.sendResetPassEmail({email:t,req:r})}},updateUserPassword:{type:ve,args:{email:{type:new ye.GraphQLNonNull(ye.GraphQLString)},password:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n,r){var t=n.email,o=n.password;return Ie.updateUserPassword({email:t,password:o,req:r})}},pageViews:{type:ke,args:{field:{type:new ye.GraphQLNonNull(ye.GraphQLString)},key:{type:new ye.GraphQLNonNull(ye.GraphQLString)}},resolve:function(e,n){return function(e){var n=e.key,r=e.field;return Ne.hsetnx(n,r,0),Ne.hincrby(n,r,1).then(function(e){return{field:n,counted:e}})}({key:n.key,field:n.field})}}}}}),je=new ye.GraphQLSchema({query:_e,mutation:De});r(38),a.a.connect(process.env.DB_ADDRESS,{useNewUrlParser:!0}),a.a.connection.on("connected",function(){console.log("connection established successfully")}),a.a.connection.on("error",function(e){console.log("connection to mongo failed "+e)}),a.a.connection.on("disconnected",function(){console.log("mongo db connection closed")}),a.a.set("useCreateIndex",!0),a.a.Promise=global.Promise;var Qe=o()(),Te=f.a.resolve("./logs");m.a.existsSync(Te)||m.a.mkdirSync(Te);var Ce=me()("access.log",{interval:"1d",path:Te});Qe.use(fe()("combined",{stream:Ce})),r(15).config({path:f.a.resolve(process.cwd(),"config/keys/.env")}),Qe.use(v()()),Qe.use(u.a.json()),Qe.use(u.a.urlencoded({extended:!0})),Qe.use(P()()),Qe.disable("x-powered-by");var Ue=[process.env.CORS_APPROVED_ADDRESS,"http://localhost:".concat(process.env.PORT)],Ae={origin:function(e,n){-1===Ue.indexOf(e)&&e?n(new Error("Not allowed by CORS")):n(null,!0)}};Qe.use(b()(Ae));var Ve=r(39)(h.a);Qe.set("trust proxy",1);var Ye=le.a.createServer(Qe),Me=new Date(Date.now()+36e5),Be=h()({secret:"3f9faa8bc0e722172cc0bdafede9f3f217474e47",resave:!1,saveUninitialized:!1,store:new Ve({prefix:"session:auth:"}),cookie:{maxAge:2592e6,expires:Me}});Qe.use(Be),Qe.use(S()()),Qe.use(l.a.initialize()),Qe.use(l.a.session()),Qe.use("/graphql",he()({schema:je,graphiql:!0})),Qe.use("/",ae),Qe.use("/",ue),Qe.use(function(e,n,r){n.status(404).send("404")}),Qe.use(function(e,n,r,t){r.locals.message=e.message,r.locals.error="development"===n.app.get("env")?e:{},r.status(e.status||500),r.send(e.message)}),Ye.listen(process.env.PORT,function(){console.log("[UserManagement]_server is running on port ".concat(process.env.PORT))})}]);